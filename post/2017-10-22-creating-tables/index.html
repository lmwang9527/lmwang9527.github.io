<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.27.1" />
  <meta name="author" content="Liming Wang">
  <meta name="description" content="Assistant Professor of Urban Studies and Planning">

  
  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  


  

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Montserrat:400,700%7cRoboto:400,400italic,700%7cRoboto&#43;Mono">
  
  <link rel="stylesheet" href="/styles.css">
  

  

  

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="/post/2017-10-22-creating-tables/">

  

  <title>Creating Tables for Microsoft Word output with R Markdown | Liming Wang</title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">Liming Wang</a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#software">
            
            <span>Software</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#teaching">
            
            <span>Teaching</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/#contact">
            
            <span>Contact</span>
          </a>
        </li>

        
        

        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Creating Tables for Microsoft Word output with R Markdown</h1>
    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2017-10-22 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      Oct 22, 2017
    </time>
  </span>

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    3 min read
  </span>
  

  
  

  
  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fa fa-folder"></i>
    
    <a href="/categories/r">R</a
    >, 
    
    <a href="/categories/reproducible-research">Reproducible Research</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Creating%20Tables%20for%20Microsoft%20Word%20output%20with%20R%20Markdown&amp;url=%2fpost%2f2017-10-22-creating-tables%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=%2fpost%2f2017-10-22-creating-tables%2f"
         target="_blank" rel="noopener">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2fpost%2f2017-10-22-creating-tables%2f&amp;title=Creating%20Tables%20for%20Microsoft%20Word%20output%20with%20R%20Markdown"
         target="_blank" rel="noopener">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    <li>
      <a class="weibo"
         href="http://service.weibo.com/share/share.php?url=%2fpost%2f2017-10-22-creating-tables%2f&amp;title=Creating%20Tables%20for%20Microsoft%20Word%20output%20with%20R%20Markdown"
         target="_blank" rel="noopener">
        <i class="fa fa-weibo"></i>
      </a>
    </li>
    <li>
      <a class="email"
         href="mailto:?subject=Creating%20Tables%20for%20Microsoft%20Word%20output%20with%20R%20Markdown&amp;body=%2fpost%2f2017-10-22-creating-tables%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      <div id="r-markdown" class="section level1">
<h1>R Markdown</h1>
<p>I have switched to solely use R Markdown for the <code>communication</code> step of my tidy work flow and found it pleasant and actually prodocutive to use. However, there is one major hurdle: output to Word format. In a perfect world, I would never need to use any Microsoft products ever again. In reality when I need to work with collaborators that do not use RMarkdown and funders that require reports in Word format (with a required style template), there is no other options. As a matter of fact, the only viable solution working with anybody that doesn’t use RMarkdown and/or <code>git</code> is still MS Word as of 2017/10.</p>
<p>Rendering R Markdown file to word_document works for the most part, except for sophisticated tables, which, unfortunately, are prevalent in most of my work.</p>
</div>
<div id="possible-solutions" class="section level1">
<h1>Possible Solutions</h1>
<p>There are a few possible solutions, none of them good enough for me at this point:</p>
<ol style="list-style-type: decimal">
<li>Gmisc::docx_document (the output is a html file with an additional <code>css</code> file; no support for Word style template);</li>
<li>Convert html output to Word document through <code>soffice</code> (the output is very basic; no support for template);</li>
<li>Pure R solution <code>officer</code> + <code>flextable</code> (They can generate good looking Word output, but they do not work with R Markdown yet (see below)).</li>
</ol>
</div>
<div id="my-solutionhack-as-of-201710" class="section level1">
<h1>My solution/hack (as of 2017/10)</h1>
<ol style="list-style-type: decimal">
<li>Render Rmd file with output set to rmarkdown::word_document;</li>
<li>The Rmd file uses texreg/htmlreg to generate html tables for regression results and saves them into separate html files (one for each table) during rendering;</li>
<li>Convert html to docx:
<ol style="list-style-type: lower-alpha">
<li>Via Word COM through py32win module (the used option)</li>
<li>Via <a href="https://github.com/evidenceprime/html-docx-js">docx-html-js</a></li>
<li>Via soffice: <code>soffice --headless --convert-to docx:&quot;MS Word 2007 XML&quot; --writer --outdir . Table\ 1.html</code></li>
</ol></li>
<li>Patch the rendered word_document and replace placeholder tables with actual tables</li>
</ol>
<div id="steps-and-files" class="section level2">
<h2>Steps and Files:</h2>
<ol style="list-style-type: decimal">
<li><code>rmarkdown::render(&quot;reg_tables_demo.Rmd&quot;)</code></li>
<li><code>python.exe html2docx.py tabs/</code> (requires py32win and Microsoft Word on Windows PC, tested with MS Office 2016 and python 2.7)</li>
<li><code>source(&quot;patch_docx_tables.R&quot;); patchFlexTables(&quot;reg_tables_demo.docx&quot;, &quot;tabs/&quot;, &quot;reg_tables_demo_final.docx&quot;)</code></li>
<li>Final <a href="https://github.com/cities-lab/rmd-docx/blob/master/reg_tables_demo_final.docx?raw=true">reg_tables_demo.docx</a></li>
</ol>
<p>All files/scripts used can be founded on github: <a href="https://github.com/cities-lab/rmd-docx" class="uri">https://github.com/cities-lab/rmd-docx</a></p>
</div>
</div>
<div id="alternativesthings-to-watch-out" class="section level1">
<h1>Alternatives/Things to watch out</h1>
<ol style="list-style-type: decimal">
<li><p><code>broom</code> &gt; <code>huxtable</code> &gt; <code>flextable</code> &gt; <code>pandoc (2.0)</code></p>
<p>This solution directly <code>knitr::knit</code> Rmd files into Word documents embedding flextables through xml chunks. It eliminates the need to run scripts outside <code>knit</code> and is a much more elegant solution than my solution above. However it is not yet an acceptable solution at the moment for a number of reasons:</p>
<ol style="list-style-type: lower-roman">
<li><code>pandoc</code> 2.0 is not yet released. Users will need to build their own <code>pandoc</code> installation from source.</li>
<li>The <code>flextable</code> implementation, standing as <a href="https://gist.github.com/mnazarov/75c2c21048e8aca9bc5acb27e0234d85">a proposal by Maxim Nazarov</a>, is yet to be incorporated in <code>flextable</code>’s code base, although Maxim’s code should work already.</li>
<li><code>broom</code> supports <a href="https://github.com/tidyverse/broom">a small set of model objects</a> than <a href="https://cran.r-project.org/web/packages/texreg/vignettes/texreg.pdf"><code>texreg</code></a>, although <code>broom</code> + <code>huxtable</code> seem to be a better solution in the long run given they follow the tidy philosophy and <code>broom</code> is now part of <code>tidyverse</code>.</li>
</ol></li>
<li><p><code>pandoc</code>, when it improves its support for sophisticated tables in unknown future</p>
<p>The table support currently in <code>pandoc</code> is rudimentary, in particular, <a href="https://github.com/jgm/pandoc/issues/1024">no support for table row/column spans</a>, which is what sent me down this rabbit hole. Once the issue is resolved, it’d be as easy and functional to produce Word outputs as html and pdf ones. Not sure when this would be resolved (if ever), as the github issue has been open for 4 years now.</p></li>
</ol>
</div>
<div id="credits" class="section level1">
<h1>Credits</h1>
<ol style="list-style-type: decimal">
<li><a href="https://github.com/davidgohel/ReporteRs/issues/68">Carsten Behring</a> for coming out with the idea and sharing his code for the hack;</li>
<li><a href="http://gforge.se/2014/07/fast-track-publishing-using-rmarkdown/">Max Gordon</a></li>
</ol>
</div>

    </div>

    
    
    
    <div class="article-tags">
      
      <a class="btn btn-primary btn-outline" href="/tags/r-markdown">R Markdown</a>
      
      <a class="btn btn-primary btn-outline" href="/tags/word">Word</a>
      
      <a class="btn btn-primary btn-outline" href="/tags/table">table</a>
      
      <a class="btn btn-primary btn-outline" href="/tags/regression">regression</a>
      
    </div>
    
    

  </div>

</article>






<div class="article-container">
  

</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Liming Wang &middot; 

      Powered by the
      <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>


<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close btn-large" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">Cite</h4>
      </div>
      <div>
        <pre><code class="modal-body tex"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-primary btn-outline js-copy-cite" href="#" target="_blank">
          <i class="fa fa-copy"></i> Copy
        </a>
        <a class="btn btn-primary btn-outline js-download-cite" href="#" target="_blank">
          <i class="fa fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

    

    
    

    
    <script async defer src="//maps.googleapis.com/maps/api/js"></script>
    

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha512-3P8rXCuGJdNZOnUx/03c1jOTnMn3rP63nBip5gOP2qmUh5YAdVAvFZ1E+QLZZbC1rtMrQb+mah3AfYW11RUrWA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.3/imagesloaded.pkgd.min.js" integrity="sha512-umsR78NN0D23AzgoZ11K7raBD+R6hqKojyBZs1w8WvYlsI+QuKRGBx3LFCwhatzBunCjDuJpDHwxD13sLMbpRA==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gmaps.js/0.4.25/gmaps.min.js" integrity="sha256-7vjlAeb8OaTrCXZkCNun9djzuB2owUsaO72kXaFDBJs=" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
      

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    

  </body>
</html>

